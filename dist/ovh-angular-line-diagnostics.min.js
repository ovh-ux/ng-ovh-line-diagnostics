/*! ovh-angular-line-diagnostics - 1.0.1 - 2018-07-25 */
"use strict";angular.module("ovh-angular-line-diagnostics",[]),angular.module("ovh-angular-line-diagnostics").provider("LineDiagnostics",function(){var a="$http",b="../bower_components/ovh-angular-line-diagnostics/dist",c=null,d="";this.setPathPrefix=function(a){return a&&(d=a),d},this.setProxy=function(b){return void 0!==b&&(a=b),a},this.setpollingApiOptions=function(a){return void 0!==a&&(c=a),c},this.setTranslationsPath=function(a){return void 0!==a&&(b=a),b},this.$get=["$injector","Poller","$translatePartialLoader","$translate",function(e,f,g,h){var i={},j=e.get(a);return i.loadTranslations=function(){return angular.forEach([b],function(a){g.addPart(a)}),h.refresh()},i.getSetDiagnostic=function(a,b){var c={faultType:"noSync"},e=b&&b.faultType?b:angular.extend(c,b||{});return e&&e.answers&&_.forIn(e.answers,function(a,b){("true"===a||"false"===a)&&(e.answers[b]="true"===e.answers[b])}),j.post(URI.expand([d,"lines","{number}","diagnostic/run"].join("/"),a).toString(),e)},i.getDeleteDiagnostic=function(a){return j.post(URI.expand([d,"lines","{number}","diagnostic/cancel"].join("/"),a).toString())},i.getWaitingValidationDiagnostics=function(){var a=e.get("$q");return j.get([d,"diagnostic/getWaitingValidationDiagnostics"].join("/")).then(function(a){return a.data},function(b){return a.reject(b)})},i.pollWaitingValidationDiagnostics=function(){return f.poll([d,"diagnostic/getWaitingValidationDiagnostics"].join("/"),c,{namespace:"tools_validation_diagnostics",method:"get",interval:3e4})},i.killPollWaitingValidationDiagnostics=function(){f.kill({namespace:"tools_validation_diagnostics"})},i.validateDiagnostics=function(a,b){var c=e.get("$q");return j.post([d,"diagnostic",a,"validate"].join("/"),b).then(function(a){return a.data},function(a){return c.reject(a)})},i.runPollGetDiagnostic=function(a,b){var e={faultType:"noSync"},g=b&&b.faultType?b:angular.extend(e,b||{});return f.poll(URI.expand([d,"lines","{number}","diagnostic/run"].join("/"),a).toString(),c,{namespace:"tools_line_diagnostics",method:"post",postData:g,interval:5e3,successRule:function(a){return"waitingRobot"!==a.status}})},i}]}),angular.module("ovh-angular-line-diagnostics").directive("lineDiagnostics",function(){return{restrict:"EA",templateUrl:"/ovh-angular-line-diagnostics/src/ovh-angular-line-diagnostics/ovh-angular-line-diagnostics.html",controllerAs:"LinediagnosticsCtrl",bindToController:!0,scope:{lineDiagnostics:"@",lineDiagnosticsType:"@",serviceName:"@lineDiagnosticsServiceName"},controller:["$q","LineDiagnostics","Toast","$translate","$state","$scope",function(a,b,c,d,e,f){function g(){var a={number:l.datas.lineNumber};return _.isUndefined(l.datas.serviceName)||(a.serviceName=l.datas.serviceName),a}function h(){b.loadTranslations().then(function(){l.translateReady=!0,i()},function(){l.translateReady=null})}function i(e){var f=e;return l.loaders.getLineStep=!0,l.datas.type&&(f=f?angular.extend(f,{faultType:l.datas.type}):{faultType:l.datas.type}),b.getSetDiagnostic(g(),f).then(function(b){if(b.data.errors){var e=b.data.errors;l.datas.lineStep=null;var f="";return e.length&&(e[0].context&&e[0].context.errorCode?(l.datas.error=e[0].context.errorCode,f=d.instant("tools_lineDiagnostics_error_context_"+e[0].context.errorCode)):f=e[0].kind+" : "+e[0].message),c.error(d.instant("tools_lineDiagnostics_error",{lineNumber:l.datas.lineNumber})+" "+f),a.reject(e)}var g=["changeProfileNotDone","ovhTicketInvalid","monitoringTodoAlreadyExists"];return b.data&&b.data.data&&b.data.data.error&&-1!==g.indexOf(b.data.data.error)&&c.error(d.instant("tools_lineDiagnostics_error_context_"+b.data.data.error)),l.datas.lineStep=b.data,j(b.data),l.formActionTodo.comment=l.datas.lineStep.data.answers.comment,b},function(b){if(l.datas.lineStep=null,!f){var e="",g=null,h=b.data&&b.data.message||"";"line diagnostic already launched by OVH"===h&&(g="internalDiagAlreadyLaunched",e=" "+d.instant("tools_lineDiagnostics_error_context_"+g)),c.error(d.instant("tools_lineDiagnostics_error",{lineNumber:l.datas.lineNumber})+e),l.datas.error=g}return a.reject(b)})["finally"](function(){l.loaders.getLineStep=!1})}function j(a){"waitingRobot"===a.status&&b.runPollGetDiagnostic(g(),l.datas.type?{faultType:l.datas.type}:void 0).then(function(a){l.datas.lineStep=a})}function k(a){a&&a.data&&!a.data.error||c.error(d.instant("tools_lineDiagnostics_post_error",{lineNumber:l.datas.lineNumber})+" : "+(a&&a.data&&a.data.error||""))}var l=this;l.translateReady=!1,l.loaders={getLineStep:!1,actionTodo:!1,toAnswer:!1},l.datas={lineStep:{},lineNumber:l.lineDiagnostics,type:l.lineDiagnosticsType,serviceName:l.serviceName},l.formActionTodo={values:{},list:[],comment:""},l.formToAnswer={values:{}},l.isNotEmptyObj=function(a){return a&&Object.keys(a).length>0},l.displayDoneTitle=function(a){return!!_.find(a,function(b,c){return null!==a[c]})},f.$watch(function(){return l.formActionTodo},function(){l.formActionTodo.list=Object.keys(_.omit(l.formActionTodo.values,function(a){return!a}))},!0),l.hasComment=function(){return!!_.find(l.datas.lineStep.data.toAnswer,{name:"comment"})},l.dateChanged=function(a,b){if(!a[b+"date"]&&!a[b+"time"])return void(a[b]=void 0);var c=a[b+"date"]||moment().format("YYYY-MM-DD"),d=(a[b+"time"]||"00:00")+":00";a[b]=moment(c,"YYYY-MM-DD").format("YYYY-MM-DD")+"T"+d+moment().format("Z")},l.setSearchDate=function(a,b,c){var d=null;-30===c?(d=moment().add(-1,"months"),a[b+"date"]=d.format("YYYY-MM-DD")):(d=moment().add(c,"days"),a[b+"date"]=d.format("YYYY-MM-DD")),a[b+"time"]||(a[b+"time"]=d.format("HH:mm")),l.dateChanged(a,b)},l.refreshLineStep=function(){l.loaders.getLineStep||i()},l.submitActionTodo=function(){l.loaders.actionTodo=!0;var a=l.formActionTodo.comment?{answers:{comment:l.formActionTodo.comment}}:{};i(angular.extend({actionsDone:l.formActionTodo.list},a)).then(k,function(){c.error(d.instant("tools_lineDiagnostics_post_error",{lineNumber:l.datas.lineNumber}))})["finally"](function(){l.loaders.actionTodo=!1})},l.conditionRefused=function(){return void 0!==l.formToAnswer.values.conditionsAccepted&&"false"===l.formToAnswer.values.conditionsAccepted},l.submitToAnswer=function(){l.loaders.toAnswer=!0,l.hasComment()||(l.formToAnswer.values.comment=angular.copy(l.formActionTodo.comment)),l.formToAnswer.values.ovhTicket&&(l.formToAnswer.values.ovhTicket=parseInt(l.formToAnswer.values.ovhTicket,10)),l.formToAnswer.values.datetimeOfAppearancedate&&delete l.formToAnswer.values.datetimeOfAppearancedate,l.formToAnswer.values.datetimeOfAppearancetime&&delete l.formToAnswer.values.datetimeOfAppearancetime,i({answers:l.formToAnswer.values}).then(k,function(){c.error(d.instant("tools_lineDiagnostics_post_error",{lineNumber:l.datas.lineNumber}))})["finally"](function(){l.loaders.toAnswer=!1})},l.deleteDiag=function(){b.getDeleteDiagnostic(g()).then(function(){e.reload()})},h()}]}}),angular.module("ovh-angular-line-diagnostics").run(["$templateCache",function(a){a.put("/ovh-angular-line-diagnostics/src/ovh-angular-line-diagnostics/ovh-angular-line-diagnostics.html",'<div id=line-diagnostics data-ng-if="LinediagnosticsCtrl.translateReady === false || LinediagnosticsCtrl.loaders.getLineStep === true"><div class=text-center><spinner></spinner></div></div><div id=line-diagnostics data-ng-if="LinediagnosticsCtrl.translateReady === null"><div class=text-center>LOADING ERROR</div></div><div id=line-diagnostics data-ng-if="LinediagnosticsCtrl.translateReady === true && LinediagnosticsCtrl.loaders.getLineStep === false"><h1>{{\'tools_lineDiagnostics_title\' | translate}}</h1><div class="alert alert-danger top-space-m20 text-center" role=alert data-ng-if="LinediagnosticsCtrl.datas.lineStep === null"><p><i class="ovh-font ovh-font-failure right-space-m8"></i> <span data-translate=tools_lineDiagnostics_error data-translate-values="{lineNumber : LinediagnosticsCtrl.datas.lineNumber}"></span><div data-ng-if=LinediagnosticsCtrl.datas.error><span data-translate="{{(\'tools_lineDiagnostics_error_context_\' + LinediagnosticsCtrl.datas.error | translate) || \'\' }}"></span></div></p><button data-ng-click=LinediagnosticsCtrl.refreshLineStep(); data-ng-disabled=LinediagnosticsCtrl.loaders.getLineStep type=button class="btn btn-default top-space-m12" title="{{::\'support_ticket_refresh\' | translate}}"><i data-ng-hide=LinediagnosticsCtrl.loaders.getLineStep class="fa fa-refresh"></i><spinner data-ng-show=LinediagnosticsCtrl.loaders.getLineStep></spinner><span data-translate=tools_lineDiagnostics_refresh></span></button></div><div data-ng-if="LinediagnosticsCtrl.datas.lineStep !== null"><div class=line-diagnostics-detail data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.seltTest.status && (!LinediagnosticsCtrl.datas.type || LinediagnosticsCtrl.datas.type===\'noSync\')"><h2 data-translate=tools_lineDiagnostics_testselt_title></h2><div class=bottom-space-m16 data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.seltTest.status === \'failed\'"><i class="ovh-font ovh-font-failure fs16 text-danger"></i> <span data-translate=tools_lineDiagnostics_testselt_error></span></div><div class=bottom-space-m16 data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.seltTest.status !== \'failed\'"><i class="ovh-font ovh-font-success fs16 text-success"></i> <span data-translate=tools_lineDiagnostics_testselt_status></span></div><div class=row data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.seltTest.status !== \'failed\'"><p class="col-xs-12 col-md-3 bodyText2" data-translate=tools_lineDiagnostics_testselt_date></p><p class="col-xs-12 col-md-9" data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.seltTest.date || \'-\'"></p></div><div class=row><p class="col-xs-12 col-md-3 bodyText2" data-translate=tools_lineDiagnostics_detail_lastSync></p><p class="col-xs-12 col-md-9" data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lastSync || \'-\'"></p></div><div class=row><div class="col-xs-12 LineScheme"><div class=infosNRA><dl><i class="ovh-font ovh-font-nra"></i><dt class=bodyText2 data-translate=tools_lineDiagnostics_detail_NRAName></dt><dd data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.nra || \'-\'"></dd><dt class=bodyText2 data-translate=tools_lineDiagnostics_detail_operator></dt><dd data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.operator || \'-\'"></dd></dl></div><div class=infosClientSide><dl><dt class=sr-only data-translate=tools_lineDiagnostics_detail_accessType></dt><dd data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lineType===\'sdsl\'"><i title={{::LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lineType}} class="ovh-font ovh-font-telecom-sdsl"></i></dd><dd data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lineType===\'adsl\'"><i title={{::LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lineType}} class="ovh-font ovh-font-xdsl-adsl"></i></dd><dd data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lineType===\'vdsl\'"><i title={{::LinediagnosticsCtrl.datas.lineStep.data.lineDetails.lineType}} class="ovh-font ovh-font-xdsl-vdsl"></i></dd><dt class=bodyText2 data-translate=tools_lineDiagnostics_detail_accessName></dt><dd data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.accessName || \'-\'"></dd><dt class=bodyText2 data-translate=tools_lineDiagnostics_detail_address></dt><dd data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.address || \'-\'"></dd></dl></div><div class=linePart><div class=lineDistances><div class=lineLength><div class=arrowPart></div><dl><dt class=sr-only data-translate=tools_lineDiagnostics_detail_NRADistance></dt><dd data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.lineDetails.length ? LinediagnosticsCtrl.datas.lineStep.data.lineDetails.length + \'m\' : \'-\'"></dd></dl><div class=arrowPart></div></div><div class=distanceIndicators></div></div><div class=locPb data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.seltTest.status !== \'failed\'"><div class=locPbContainer><div class=pbIcon><i class="ovh-font ovh-font-failure fs20 text-danger"></i></div><div class="problemDescription left-space-p12"><h3>{{\'tools_lineDiagnostics_testselt_state_\' + LinediagnosticsCtrl.datas.lineStep.data.seltTest.state | translate}} {{\' tools_lineDiagnostics_testselt_preloc_\' + LinediagnosticsCtrl.datas.lineStep.data.seltTest.preloc | translate}}</h3><p><span class=bodyText2 data-translate=tools_lineDiagnostics_testselt_distance></span> : <span data-ng-bind="LinediagnosticsCtrl.datas.lineStep.data.seltTest.distance ? LinediagnosticsCtrl.datas.lineStep.data.seltTest.distance + \'m\' : \'-\'"></span></p></div></div></div></div></div></div></div><div data-ng-if=LinediagnosticsCtrl.datas.lineStep.data.actionsDone.length><h2 data-translate=tools_lineDiagnostics_actionDone_title></h2><div class=line-diagnostics-detail><ul class=list-unstyled><li class=bottom-space-m12 data-ng-repeat="actionsDone in LinediagnosticsCtrl.datas.lineStep.data.actionsDone"><i class="ovh-font ovh-font-success fs16 text-success"></i> <span class=left-space-p8>{{::\'tools_lineDiagnostics_action_\' + actionsDone | translate}}</span></li></ul></div></div><div data-ng-if="LinediagnosticsCtrl.isNotEmptyObj(LinediagnosticsCtrl.datas.lineStep.data.answers) && LinediagnosticsCtrl.displayDoneTitle(LinediagnosticsCtrl.datas.lineStep.data.answers)"><h2 data-translate=tools_lineDiagnostics_answers_title></h2><div class=line-diagnostics-detail><div class="form-horizontal full-height"><div class=form-group data-ng-repeat="(key, answers) in LinediagnosticsCtrl.datas.lineStep.data.answers" data-ng-if="answers!==null"><label class="col-xs-12 col-md-6 bodyText2 top-space-p0">{{::\'tools_lineDiagnostics_answers_\' + key | translate}}</label><div class="col-xs-12 col-md-6"><span data-ng-if="key!==\'comment\'" data-ng-bind="(answers ? \'tools_lineDiagnostics_detail_yes\' : \'tools_lineDiagnostics_detail_no\') | translate"></span> <span data-ng-if="key===\'comment\'" data-ng-bind="answers ? answers : (\'tools_lineDiagnostics_detail_no\' | translate)"></span></div></div></div></div></div><div class=rightPanel data-ng-if=LinediagnosticsCtrl.datas.lineStep.data.actionsToDo.length><h2 data-translate=tools_lineDiagnostics_todo_title></h2><div class=line-diagnostics-detail><form class="full-height clearfix" name=formActionTodo novalidate><div class=checkbox data-ng-repeat="actionTodo in LinediagnosticsCtrl.datas.lineStep.data.actionsToDo"><label><input type=checkbox data-ng-required=true data-ng-model=LinediagnosticsCtrl.formActionTodo.values[actionTodo.name]> {{::\'tools_lineDiagnostics_action_\' + actionTodo.name | translate}}</label></div><div class="form-group comment"><label for=formActionTodo_comment class=control-label>{{::\'tools_lineDiagnostics_toanswer_comment\' | translate}}</label><div><textarea id=formActionTodo_comment name=formActionTodo_comment class="form-control vertical-resize" ng-maxlength=200 rows="{{ !!toAnswer.defaultValue ? 1 : 5}}" data-ng-model=LinediagnosticsCtrl.formActionTodo.comment></textarea></div></div><button type=button class="btn btn-default" data-ng-click=LinediagnosticsCtrl.deleteDiag()><span data-translate=tools_lineDiagnostics_delete_button></span></button> <button type=button class="btn btn-primary pull-right" data-ng-disabled=formActionTodo.$invalid data-ng-click=LinediagnosticsCtrl.submitActionTodo()><spinner data-ng-show=LinediagnosticsCtrl.loaders.actionTodo></spinner><span data-translate=tools_lineDiagnostics_next_button></span></button></form></div></div><div class=rightPanel data-ng-if="LinediagnosticsCtrl.datas.lineStep.data.toAnswer.length && LinediagnosticsCtrl.datas.lineStep.status === \'waitingHuman\'"><h2 data-translate=tools_lineDiagnostics_toanswer_title></h2><div class=line-diagnostics-detail><form class="full-height clearfix" name=formToAnswer novalidate><div data-ng-repeat="toAnswer in LinediagnosticsCtrl.datas.lineStep.data.toAnswer"><div class=form-group data-ng-if="toAnswer.type===\'boolean\'"><div data-ng-if="toAnswer.name===\'conditionsAccepted\'" class=inline style=margin-right:5px><label class="block pointer"><flat-checkbox><input type=checkbox data-ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] name="checkbox{{ toAnswer.name}}" id="checkbox{{ toAnswer.name }}" ng-required="toAnswer.required"></flat-checkbox><span class=left-space-m8>{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></span></label></div><p data-ng-if="toAnswer.name!==\'conditionsAccepted\'">{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></p><div data-ng-if="toAnswer.name!==\'conditionsAccepted\'" class=row><div class=col-xs-6><label><flat-radio class=pointer><input value=true type=radio ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] ng-required=toAnswer.required></flat-radio><span class=left-space-m12 data-translate=tools_lineDiagnostics_detail_yes></span></label></div><div class=col-xs-6><label><flat-radio class=pointer><input value=false type=radio ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] ng-required=toAnswer.required></flat-radio><span class=left-space-m12 data-translate=tools_lineDiagnostics_detail_no></span></label></div></div></div><div class=form-group data-ng-if="toAnswer.type===\'string\'" data-ng-init="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] = toAnswer.defaultValue || \'\' "><label for=formToAnswer_{{toAnswer.name}} class=control-label>{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></label><div><textarea id=formToAnswer_{{::toAnswer.name}} name=formToAnswer_{{::toAnswer.name}} class="form-control vertical-resize" rows="{{ !!toAnswer.defaultValue ? 1 : 5}}" data-ng-required=toAnswer.required data-ng-pattern=toAnswer.pattern data-ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name]></textarea></div></div><div class=form-group data-ng-if="toAnswer.type===\'long\'" data-ng-init="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] = toAnswer.defaultValue || \'\' "><label for=formToAnswer_{{toAnswer.name}} class=control-label>{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></label><div><input pattern=[0-9]{1,8} id=formToAnswer_{{::toAnswer.name}} name=formToAnswer_{{::toAnswer.name}} data-ng-required=toAnswer.required data-ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name]></div></div><div class=form-group data-ng-if="toAnswer.type===\'enum\'" data-ng-init="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] = toAnswer.defaultValue || \'\' "><label for=formToAnswer_{{toAnswer.name}} class=control-label>{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></label><div><select id=formToAnswer_{{::toAnswer.name}} name=formToAnswer_{{::toAnswer.name}} class="form-control no-space" data-ng-options=" (\'tools_lineDiagnostics_toanswer_\' + toAnswer.name + \'_enum_\' + value | translate ) for value in toAnswer.enumValues" data-ng-required=toAnswer.required data-ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name]><option data-ng-if=!toAnswer.required value=""></option></select></div></div><div class=form-group data-ng-if="toAnswer.type===\'datetime\'" data-ng-init="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name] = toAnswer.defaultValue || \'\' "><div class=row><div class=col-sm-12><label for=formToAnswer_{{toAnswer.name}}_date class=control-label>{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></label></div><div class=col-sm-7><div class=input-group><div class=input-group-btn><div class=btn-group data-uib-dropdown is-open=datepick.isopen><button id=datepick_choices type=button class="btn btn-default btn-sm" data-uib-dropdown-toggle><i class="fa fa-calendar-o"></i></button><ul data-uib-dropdown-menu><li role=menuitem><button class="full-width no-style text-left" type=button data-ng-click="LinediagnosticsCtrl.setSearchDate(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name, 0); datepick.isopen=false;" data-translate=tools_lineDiagnostics_date_now></button></li><li role=menuitem><button class="full-width no-style text-left" type=button data-ng-click="LinediagnosticsCtrl.setSearchDate(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name, -1); datepick.isopen=false;" data-translate=tools_lineDiagnostics_date_yesterday></button></li><li role=menuitem><button class="full-width no-style text-left" type=button data-ng-click="LinediagnosticsCtrl.setSearchDate(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name, -3); datepick.isopen=false;" data-translate=tools_lineDiagnostics_date_3d></button></li><li role=menuitem><button class="full-width no-style text-left" type=button data-ng-click="LinediagnosticsCtrl.setSearchDate(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name, -7); datepick.isopen=false;" data-translate=tools_lineDiagnostics_date_1w></button></li><li role=menuitem><button class="full-width no-style text-left" type=button data-ng-click="LinediagnosticsCtrl.setSearchDate(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name, -30); datepick.isopen=false;" data-translate=tools_lineDiagnostics_date_1m></button></li></ul></div></div><input class=form-control id=formToAnswer_{{toAnswer.name}}_date placeholder=YYYY-MM-DD pattern=[0-9]{4}-[0-9]{2}-[0-9]{2} data-ng-change="LinediagnosticsCtrl.dateChanged(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name)" data-ng-model="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name+\'date\']" data-ng-required=toAnswer.required> <span class=input-group-btn data-ng-show="!!LinediagnosticsCtrl.formToAnswer.values[toAnswer.name+\'date\']"><button class="btn btn-default btn-sm" type=button data-ng-click="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name+\'date\']=null;"><i class="fa fa-times"></i></button></span></div></div><div class=col-sm-5><div class=input-group><input class=form-control placeholder=HH:mm pattern=[0-9]{2}:[0-9]{2} id=formToAnswer_{{::toAnswer.name}} name=formToAnswer_{{::toAnswer.name}} data-ng-required=toAnswer.required data-ng-change="LinediagnosticsCtrl.dateChanged(LinediagnosticsCtrl.formToAnswer.values, toAnswer.name)" data-ng-model="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name+\'time\']"><span class=input-group-btn data-ng-show="!!LinediagnosticsCtrl.formToAnswer.values[toAnswer.name+\'time\']"><button class="btn btn-default btn-sm" type=button data-ng-click="LinediagnosticsCtrl.formToAnswer.values[toAnswer.name+\'time\']=null;"><i class="fa fa-times"></i></button></span></div></div></div></div><div class=form-group data-ng-if=toAnswer.possibleValues.length><label for=formToAnswer_{{toAnswer.name}} class=control-label>{{::\'tools_lineDiagnostics_toanswer_\' + toAnswer.name | translate}} <span class=red data-ng-if=toAnswer.required>*</span></label><div><select id=formToAnswer_{{::toAnswer.name}} name=formToAnswer_{{::toAnswer.name}} class="form-control no-space" data-ng-options="value.id as value.label for value in toAnswer.possibleValues" data-ng-required=toAnswer.required data-ng-model=LinediagnosticsCtrl.formToAnswer.values[toAnswer.name]><option data-ng-if=!toAnswer.required value=""></option></select></div></div></div><div data-ng-if=!LinediagnosticsCtrl.hasComment()><div class=form-group><label for=formActionTodo_comment class=control-label>{{::\'tools_lineDiagnostics_toanswer_comment\' | translate}}</label><div><textarea id=formActionTodo_comment name=formActionTodo_comment class="form-control vertical-resize" rows="{{ !!toAnswer.defaultValue ? 1 : 5}}" data-ng-model=LinediagnosticsCtrl.formActionTodo.comment></textarea></div></div></div><button type=button class="btn btn-default" data-ng-click=LinediagnosticsCtrl.deleteDiag() data-ng-if="LinediagnosticsCtrl.datas.lineStep.status !== \'problem\'"><span data-translate=tools_lineDiagnostics_delete_button></span></button> <button type=button class="btn btn-primary pull-right" data-ng-if="LinediagnosticsCtrl.datas.lineStep.status !== \'problem\'" data-ng-disabled="formToAnswer.$invalid || LinediagnosticsCtrl.conditionRefused()" data-ng-click=LinediagnosticsCtrl.submitToAnswer()><spinner data-ng-show=LinediagnosticsCtrl.loaders.toAnswer></spinner><span data-translate=tools_lineDiagnostics_next_button></span></button></form></div></div><div class=line-diagnostics-detail data-ng-if="LinediagnosticsCtrl.datas.lineStep.status !== \'waitingHuman\'"><div class="alert text-center" data-ng-class="{\n'+"                    'alert-info' : LinediagnosticsCtrl.datas.lineStep.status === 'waitingRobot'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'sleeping'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'waitingValidation'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'cancelled'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'haveToConnectModemOnTheRightPlug'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'noSyncFaultDiagnosticRequired'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'connectionProblem',\n\n                    'alert-danger' : LinediagnosticsCtrl.datas.lineStep.status === 'problem'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'validationRefused',\n\n                    'alert-success' : LinediagnosticsCtrl.datas.lineStep.status === 'resolvedAfterTests'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'interventionRequested'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'noBandwidthFault'\n                                || LinediagnosticsCtrl.datas.lineStep.status === 'noProblemAnymore'\n                }\" role=alert><p><i data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'waitingRobot'\n                        || LinediagnosticsCtrl.datas.lineStep.status === 'sleeping'\n                        || LinediagnosticsCtrl.datas.lineStep.status === 'waitingValidation'\" class=\"ovh-font ovh-font-inprogress right-space-m8\"></i> <i data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'validationRefused'\" class=\"ovh-font ovh-font-failure\"></i> <i data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'cancelled'\" class=\"ovh-font ovh-font-failure\"></i> <i data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'problem'\" class=\"ovh-font ovh-font-warning\"></i> <i data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'resolvedAfterTests'\n                        || LinediagnosticsCtrl.datas.lineStep.status === 'interventionRequested'\" class=\"ovh-font ovh-font-success\"></i> <span data-translate=tools_lineDiagnostics_robot_{{LinediagnosticsCtrl.datas.lineStep.status}}></span> <span data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'problem' &&\n                        LinediagnosticsCtrl.datas.lineStep.data.error && LinediagnosticsCtrl.datas.lineStep.data.ovhTicket\" data-translate=tools_lineDiagnostics_robot_problem_ticket data-translate-values=\"{ovhTicket : LinediagnosticsCtrl.datas.lineStep.data.ovhTicket}\"></span><div data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status==='interventionRequested' &&\n                        LinediagnosticsCtrl.datas.lineStep.data.ovhTicket\"><span class=bold data-translate=tools_lineDiagnostics_robot_interventionRequested_otrsticket data-translate-values=\"{ovhTicket : LinediagnosticsCtrl.datas.lineStep.data.ovhTicket}\"></span></div><div data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status==='interventionRequested' &&\n                        LinediagnosticsCtrl.datas.lineStep.data.operatorTicketId\"><span class=bold data-translate=tools_lineDiagnostics_robot_interventionRequested_operatorticketid data-translate-values=\"{operatorTicketId : LinediagnosticsCtrl.datas.lineStep.data.operatorTicketId}\"></span></div><div data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status==='interventionRequested' &&\n                        LinediagnosticsCtrl.datas.lineStep.data.ovhInterventionId\"><span class=bold data-translate=tools_lineDiagnostics_robot_interventionRequested_ovhinterventionid data-translate-values=\"{ovhInterventionId : LinediagnosticsCtrl.datas.lineStep.data.ovhInterventionId}\"></span></div><span data-ng-if=!!LinediagnosticsCtrl.datas.lineStep.data.robotAction>({{'tools_lineDiagnostics_robotAction_' + LinediagnosticsCtrl.datas.lineStep.data.robotAction | translate}})</span></p></div><button type=button class=\"btn btn-default\" data-ng-if=\"LinediagnosticsCtrl.datas.lineStep.status === 'problem'\n                    || LinediagnosticsCtrl.datas.lineStep.status === 'validationRefused'\n                    || LinediagnosticsCtrl.datas.lineStep.status === 'resolvedAfterTests'\n                    || LinediagnosticsCtrl.datas.lineStep.status === 'interventionRequested'\n                    || LinediagnosticsCtrl.datas.lineStep.status === 'haveToConnectModemOnTheRightPlug'\n                    || LinediagnosticsCtrl.datas.lineStep.status === 'noSyncFaultDiagnosticRequired'\n                    || LinediagnosticsCtrl.datas.lineStep.status === 'connectionProblem'\n                    || LinediagnosticsCtrl.datas.lineStep.data.isInternal\" data-ng-click=LinediagnosticsCtrl.deleteDiag()><span data-translate=tools_lineDiagnostics_delete_button></span></button></div></div></div>")}]);